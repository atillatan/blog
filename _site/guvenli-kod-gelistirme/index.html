<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.9.0/github-markdown.min.css" integrity="sha256-AcEoN20lbehGx2iA6fVk4geoblRBOAUmz+gEM9QE59Y=" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/7.1.0/mermaid.min.js" integrity="sha256-M3OC0Q6g4/+Q4j73OvnsnA+lMkdAE5KgupRHqTiPbnI=" crossorigin="anonymous"></script>
<script>mermaid.initialize({startOnLoad:true});</script>
  <link rel="stylesheet" href="/assets/css/core.css"/>
  <link rel="stylesheet" href="/assets/css/site.css"/>
    <link rel="stylesheet" href="/assets/style.css"/>
  <link rel="shortcut icon" href="/favicon.ico" />
  <meta name="robots" content="index, follow">
  <meta name="author" content="Atilla Tanrikulu" />
  <meta name="description" content="atilla.tanrikulu.biz | Bir çok kategoride güzel ve özgün makaleler okuyabileceğiniz güncel bir blog."/>
  <title>Guvenlik Kod Gelistirme. Atilla Tanrikulu</title>
  <base href="">
</head>


  <body>
    <header class="container">
           <nav class="navbar navbar-inverse container-fluid navbar-fixed-top">
  <div>
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
              <span class="sr-only">Menü</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
          </button>
      <a class="navbar-brand" href="/">Atilla Tanrıkulu</a>
    </div>
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="/"><span class="glyphicon glyphicon-home"></span>Anasayfa</a></li>
        <li><a href="/about/"><span class="glyphicon glyphicon-king"></span>Hakkında</a></li>

      </ul>
      <form class="navbar-form navbar-left" role="search">
        <div class="form-group-sm">
          <div class="input-group">
            <input type="text" class="form-control" placeholder="Aranacak ifade">
            <span class="input-group-btn"><button class="btn btn-success btn-sm">Ara!</button></span>
          </div>
        </div>

      </form>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/contact/"><span class="glyphicon glyphicon-envelope"></span> İletişim</a></li>
        <li><a href="http://www.filehoo.com"><span class="glyphicon glyphicon-link"></span> Filehoo</a></li>
      </ul>

    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container-fluid -->
</nav>

    </header>
        <section class="container">
            <div class="row">
                <div class="col-md-3">
                   <div class="panel panel-default">
     <div class="panel-heading text-center"><img class="img-responsive img-circle" src="/assets/img/linkedin_profile_photo.jpg" style="padding-left:30px;padding-right:30px;"/>
       <h2>Atilla Tanrikulu</h2>
       <ul class="nav navbar-nav text-center">
         <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
           <li><a href="https://www.linkedin.com/in/atillatan" target="_blank"><i class="fa fa-linkedin-square fa-2x social"></i></a></li>
           <li><a href="https://twitter.com/atillatanrikulu" target="_blank"><i class="fa fa-twitter-square fa-2x social"></i></a></li>
           <li><a href="mailto:info@tanrikulu.biz" target="_blank"><i class="fa fa-envelope-square fa-2x social"></i></a></li>
       </ul>
     </div>
     <div class="panel-body text-left">
         <div class="row">
             <div class="col-md-12 ">
               <p>
                Bu kişisel blog sitesindeki makaleler, genellikle iş hayatımda unutmak istemediğim bilgileri
                 not alma isteğim sonucunda oluşmuştur.
              </p>
             </div>

         </div>
     </div>
 </div>

                   <!-- Panel -->
<div class="panel panel-default" style="margin-bottom:0px;">
  <div class="panel-heading">
    <h4 class="panel-title">Makaleler</h4>
  </div>

</div>
<div class="list-group">


<a class="list-group-item" href="/Duckdns-ile-Dinamik-IP-adresinize-Alan-adi-tanimlayin/">Duckdns ile Dinamik IP adresinize Alan adi tanimlayin.</a>



<a class="list-group-item" href="/How-to-use-Github-Pages-for-static-website/">How to use Github Pages for static website</a>



<a class="list-group-item" href="/IdentityServer-nedir/">IdentityServer Nedir</a>



<a class="list-group-item" href="/JMETER-NOTLARI-KURULUM-VE-KULLANIM/">JMater notlari, kurulum ve kullanim</a>



<a class="list-group-item" href="/Learn-Jekyll-in-12-Steps/">Learn Jekyll in 12 Steps</a>



<a class="list-group-item" href="/OAuth-2-nedir/">OAuth 2.0  Nedir  (RFC6749)</a>



<a class="list-group-item" href="/SQL-Table-Data-Compare/">SQL table data compare, and prepare insert satements</a>



<a class="list-group-item" href="/Sql-server-icin-maliyetli-sorgularin-tespit-edilmesi/">Sql server icin maliyetli sorgularin tespit edilmesi</a>



<a class="list-group-item" href="/automater-ile-application-yapmak/">Automater ile application yapmak</a>



<a class="list-group-item" href="/docker-cok-kullanilan-komutlar/">Docker Cok kullanilan komutlar</a>



<a class="list-group-item" href="/docker-nginx-mdwiki/">Docker Nginx mdwiki</a>



<a class="list-group-item" href="/guvenli-kod-gelistirme/">Guvenlik Kod Gelistirme</a>



<a class="list-group-item" href="/redis-kurulum-ayarlar/">Redis Kurulumu ve ayarlari</a>



<a class="list-group-item" href="/tfs-deployment/">TFS ile Otomatik deployment yapmak</a>


</div>


<div class="panel panel-default" style="margin-bottom:0px;">
 <div class="panel-heading">
   <h4 class="panel-title">Yakında Hazırlanacak</h4>
 </div>
  <a class="list-group-item" href="#">Mac OS  bilgisayarda Wine kullanimi ve Wine icin tavsiye programlar.</a>
  <a class="list-group-item" href="#">Mac icin tavsiye programlar</a>
  <a class="list-group-item" href="#">Atom icin tavsiye pluginler</a>
  <a class="list-group-item" href="#">Chain of responsibility Design Pattern</a>
  <a class="list-group-item" href="#">Kurumsal yazilmlarda kullanilan Design Pattern'ler</a>
  <a class="list-group-item" href="#">Kurumsal yazilimlarda Cache kullanimi</a>
</div>
<div class="list-group">

<a class="list-group-item" href="#"></a>


</div>

<!--

<div class="panel panel-default" style="margin-bottom:0px;">
  <div class="panel-heading">
    <h4 class="panel-title">Kategoriler</h4>
  </div>

</div>
<div class="list-group">


<a class="list-group-item" href="/Duckdns-ile-Dinamik-IP-adresinize-Alan-adi-tanimlayin/">Duckdns ile Dinamik IP adresinize Alan adi tanimlayin.</a>



<a class="list-group-item" href="/How-to-use-Github-Pages-for-static-website/">How to use Github Pages for static website</a>



<a class="list-group-item" href="/IdentityServer-nedir/">IdentityServer Nedir</a>



<a class="list-group-item" href="/JMETER-NOTLARI-KURULUM-VE-KULLANIM/">JMater notlari, kurulum ve kullanim</a>



<a class="list-group-item" href="/Learn-Jekyll-in-12-Steps/">Learn Jekyll in 12 Steps</a>



<a class="list-group-item" href="/OAuth-2-nedir/">OAuth 2.0  Nedir  (RFC6749)</a>



<a class="list-group-item" href="/SQL-Table-Data-Compare/">SQL table data compare, and prepare insert satements</a>



<a class="list-group-item" href="/Sql-server-icin-maliyetli-sorgularin-tespit-edilmesi/">Sql server icin maliyetli sorgularin tespit edilmesi</a>



<a class="list-group-item" href="/automater-ile-application-yapmak/">Automater ile application yapmak</a>



<a class="list-group-item" href="/docker-cok-kullanilan-komutlar/">Docker Cok kullanilan komutlar</a>



<a class="list-group-item" href="/docker-nginx-mdwiki/">Docker Nginx mdwiki</a>



<a class="list-group-item" href="/guvenli-kod-gelistirme/">Guvenlik Kod Gelistirme</a>



<a class="list-group-item" href="/redis-kurulum-ayarlar/">Redis Kurulumu ve ayarlari</a>



<a class="list-group-item" href="/tfs-deployment/">TFS ile Otomatik deployment yapmak</a>


</div>
-->


                </div>
                <div class="col-md-9 content">
                   <article class="markdown-body">
                    <div class="alert alert-danger">
 <strong>Not!</strong> Merhaba! bloga ilk asamada icerik olarak kendi aldigim notlari direk olarak icerige koydugum icin, icerikte bircok imla hatalasi ve yazım yanlışları bulunmaktadir, kusura bakmayın,
 en yakın zamanda üzerinden geçip düzeltmeler yapacağım. Hoşgörünüz için şimdiden teşekkür ediyorum.
</div>

                    <h1 id="guvenlik-kod-gelistirme">Guvenlik Kod Gelistirme</h1>

<h2 id="temel-kavramlar">Temel Kavramlar</h2>

<ul>
  <li>OpenSSL deki zafiyet</li>
</ul>

<p><code class="highlighter-rouge">heartbeat</code> zafiyetine <code class="highlighter-rouge">heardbleed</code> demisler, burada <code class="highlighter-rouge">hearthbeat(string char[], int length)</code> gibi bir methodun icinde memoryden alacagi rasgele string degeri verilmis bundan faydalanan hacker lar, memoryi ele gecirebilmisler.</p>

<ul>
  <li>
    <p>CVSS (Common Vulnerability Scoring System) score zafiyet(savunmasizlik) puanlamasidir hearthbleed zaafiyeti 11 degerinde bir zaafiyet almis, cok yuksek</p>
  </li>
  <li>
    <p>Guvenlik zaafiyerlerinin bir cogu string concatanation ile olusur.</p>
  </li>
  <li>
    <p>Guvenlik zaafiyetlerinin bir cogu kullanicilardan aldigimiz vei ile kodu karistirmamizdan kaynaklanir.</p>
  </li>
</ul>

<p><strong>Guvenli yazilim:</strong> normal sartlar altinda dogru calisiyor ise, saldiri altinda da dogru calismasi demektir.</p>

<p><strong>Hatalarin kullaniciya verilmesi:</strong> Hatalar da son kullaniciya full stacktrace verilmemelidir, guvenlik acigidir.</p>

<ul>
  <li>Kullanicilardan aldigimiz girdileri azaltmak basitlestirme bazinda iyi bir yontemdir.</li>
  <li>Kullanicilardan aldiklarimi bilgilieri direk olarak kod ile birlesirmek yanlis bir yontemdir,</li>
  <li>Her bir girdinin kontrol edilmesi gerekmektedir.</li>
</ul>

<p><strong>Guvenli kod gelistirme ilkeleri</strong></p>

<ul>
  <li>Kullanicilardan alinan girdi minimumda tutulmali.</li>
  <li>Kullanicilardan alinan girdilerin kontrolsuz string birlestirme isleminde kullanilmamasi</li>
  <li>Her katmanda yetkilendirme yapilmasi</li>
</ul>

<h3 id="sop---same-origin-policy">SOP - Same Origin Policy</h3>

<p>Ayni kaynak politikasi Browserlar, scriptler icin bu kurali kullanir, bir script sadece kendi kaynagina ait isteklerde bulunabilir.</p>

<ul>
  <li>
    <p><strong>XMLHttpRequest (AJAX) icin SOP</strong> www.abc.com daki bir script kendi kaynagindaki (www.abc.com) daki herhangi bir adrese request gonderebilir ve cevabini alir. Fakat www.abc.com adresindeki bir script www.xyz.com adresine bir request gonderdiginde cevabini alamaz.</p>
  </li>
  <li>
    <p><strong>Browser Cookie yonetimi</strong> Browser daha once ayni domain den aldigi bir cookie yi ayni domain e giderken isteklere otomatik ekler.</p>

    <ul>
      <li>domain adi farkli olursa cookiler gondedilmez</li>
      <li>http den https e yada https ten http ye giderken de SOP engelleme yapar.</li>
      <li>port farkli olursa SOP engeller,</li>
      <li>domain adi tam uyusmalidir, subdomain ler arasi da SOP engelleme yapar.</li>
    </ul>
  </li>
</ul>

<p>session hijacking : javascript ile cookie caliniyor, sayfamiza bir script gomer ise.</p>

<h2 id="tedbir-alma-yontemleri">TEDBIR ALMA YONTEMLERI</h2>

<p><strong>Not: saldirilarda encoding tedbir almanin birinci kurali</strong> tum encodingler yerinde kullanilmalidir.</p>

<ul>
  <li>Html encoding</li>
  <li>Attribute Encoding</li>
  <li>URL encoding</li>
  <li>Javascript Encoding</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"   --&gt; \x22
&gt;  --&gt;  \x3c
</code></pre></div></div>

<p><strong>AntiXSS</strong> : microsoftun bir kutuphanesidir, yazilimda kullanilabilir encoding ve decoding yaparken bu library kullanmak faydali olabilir.</p>

<ul>
  <li>Burp adindaki tool kullanilarak Httmp Request ve Response lar izlenebilir, http proxy olarak calisiyor., girilenleri gosteriyor ve mudehale etme imkani veriryor.</li>
</ul>

<h3 id="1--blacklisting">1- Blacklisting</h3>

<p>Bilinen kotu karakter veya karakter kumelerinin reddedilmesidir. Cok kullanilan ama guvensiz bir girdi denetimidir. ornegin <code class="highlighter-rouge">&lt;script&gt;</code> gecen girdilerin reddedilmesi. <code class="highlighter-rouge">or 1=1</code> gecen girdilerin reddedilmesi.</p>

<p>blacklisting kotudur, bir onlem degildir.</p>

<h3 id="2--whitelisting">2- Whitelisting</h3>

<p>Sadece iyi karakter veya karakter kumelerinin kabul edilmesidir. Guvenli bir girdi denetimidir.</p>

<h3 id="3--normalizasyon">3- Normalizasyon</h3>

<p>Bir dizginin en basit, en temel haline cevrilmesidir.</p>

<h3 id="4--sanitize---temizleme-islemi">4- Sanitize - Temizleme islemi</h3>

<p>Girdinin kabul edilebilir bir formata donusturulmesidir. ornegin girdi icindeki tek tirnak karakterlerinin temizlenmesi <code class="highlighter-rouge">&lt;script&gt;</code> ifadelerinin temizlenmesi.</p>

<h3 id="5--encoding">5- Encoding</h3>

<p>Girdi icindeki ozel karakterlerin baska bir formata donusturulmesidir.</p>

<h2 id="zaafiyet-cesitleri">ZAAFIYET CESITLERI</h2>

<h3 id="1-xxe---xml-external-entity">1. XXE - Xml External Entity</h3>

<p><strong>Tanim</strong>: XML dokumanlarinin DTD kismina, zararli kod eklenebilmektedir. XML parser kutuphaneleri DTD kismini okuyup calistirmaktadir.</p>

<p><strong>Onlem</strong>: Kullanicidan aldigimiz XML lerin DTD kisminin calistirilmasini engellemeliyiz. asagida .net icinde kullanilan bir ornek vardir.</p>

<p>XML dokumanlari okur iken DTD bilgisinin okunmasina izin verir isek buradan host dosyasi bile okunabilmektedir.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>

            <span class="c1">//guvensiz: XmlReaderSettings setting=new XmlRaderSettings(){DtdProcessing=parse}</span>
            <span class="c1">//parse yetkisi verilir ise guvenlik acigi oluyor.</span>
            <span class="c1">//guvenli: XmlReaderSettings setting=new XmlRaderSettings(){DtdProcessing=Ignore}</span>

            <span class="n">XmlReader</span> <span class="n">xmlReader</span> <span class="p">=</span> <span class="n">XmlReader</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">settings</span><span class="p">);</span>

            <span class="kt">var</span> <span class="n">root</span> <span class="p">=</span> <span class="n">XDocument</span><span class="p">.</span><span class="nf">Load</span><span class="p">(</span><span class="n">xmlReader</span><span class="p">,</span> <span class="n">LoadOptions</span><span class="p">.</span><span class="n">PreserveWhitespace</span><span class="p">);</span>

            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reportItemElement</span> <span class="k">in</span> <span class="n">root</span><span class="p">.</span><span class="n">Root</span><span class="p">.</span><span class="nf">Elements</span><span class="p">(</span><span class="s">"issue"</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="kt">string</span> <span class="n">vuln</span> <span class="p">=</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">reportItemElement</span><span class="p">.</span><span class="nf">Element</span><span class="p">(</span><span class="s">"name"</span><span class="p">);</span>
                <span class="kt">string</span> <span class="n">host</span> <span class="p">=</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">reportItemElement</span><span class="p">.</span><span class="nf">Element</span><span class="p">(</span><span class="s">"host"</span><span class="p">);</span>
                <span class="kt">string</span> <span class="n">severity</span> <span class="p">=</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">reportItemElement</span><span class="p">.</span><span class="nf">Element</span><span class="p">(</span><span class="s">"severity"</span><span class="p">);</span>

                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Host: "</span> <span class="p">+</span> <span class="n">host</span><span class="p">);</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Vulnerability: "</span> <span class="p">+</span> <span class="n">vuln</span><span class="p">);</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Severity: "</span> <span class="p">+</span> <span class="n">severity</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>Host dosyasini okkuyabilen bir XML ornegi</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="cp">&lt;!DOCTYPE issues [
  &lt;!ENTITY % a "&lt;!ENTITY foo SYSTEM 'file:///C:/Windows/System32/drivers/etc/hosts'&gt;</span>"&gt;  %a;
]&gt;
<span class="nt">&lt;issues</span> <span class="na">burpVersion=</span><span class="s">"1.6.01"</span> <span class="na">exportTime=</span><span class="s">"Thu Aug 14 03:38:12 VET 2014"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;issue&gt;</span>
    <span class="nt">&lt;serialNumber&gt;</span>5626899943859184640<span class="nt">&lt;/serialNumber&gt;</span>
    <span class="nt">&lt;type&gt;</span>1049088<span class="nt">&lt;/type&gt;</span>
    <span class="nt">&lt;name&gt;</span>Fake Vulnerability<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;host</span> <span class="na">ip=</span><span class="s">"176.28.50.165"</span><span class="nt">&gt;</span>http://testphp.vulnweb.com<span class="nt">&lt;/host&gt;</span>
    <span class="nt">&lt;path&gt;</span><span class="cp">&lt;![CDATA[/search.php]]&gt;</span><span class="nt">&lt;/path&gt;</span>
    <span class="nt">&lt;location&gt;</span><span class="cp">&lt;![CDATA[/search.php [manual insertion point 1]]]&gt;</span><span class="nt">&lt;/location&gt;</span>
    <span class="nt">&lt;severity&gt;</span><span class="ni">&amp;foo;</span><span class="nt">&lt;/severity&gt;</span>
    <span class="nt">&lt;confidence&gt;</span>Tentative<span class="nt">&lt;/confidence&gt;</span>
    <span class="nt">&lt;issueBackground&gt;</span><span class="cp">&lt;![CDATA[SQL injection vulnerabilities arise ]]&gt;</span><span class="nt">&lt;/issueBackground&gt;</span>
    <span class="nt">&lt;remediationBackground&gt;</span><span class="cp">&lt;![CDATA[The most effective way to prevent SQL injection .&lt;/li&gt;&lt;/ul&gt;]]&gt;</span><span class="nt">&lt;/remediationBackground&gt;</span>
    <span class="nt">&lt;issueDetail&gt;</span><span class="cp">&lt;![CDATA[The manual insertion point 1 appears to be vulnerable to SQL injection attacks. The payload &lt;b&gt;' and benchmark(20000000,sha1(1))-- &lt;/b&gt; was submitted in the manual insertion point 1\. The application took &lt;b&gt;8591&lt;/b&gt; milliseconds to respond to the request, compared with &lt;b&gt;50&lt;/b&gt; milliseconds for the original request, indicating that the injected SQL command caused a time delay.&lt;br&gt;&lt;br&gt;The database appears to be MySQL.]]&gt;</span><span class="nt">&lt;/issueDetail&gt;</span>
    <span class="nt">&lt;requestresponse&gt;</span>
      <span class="nt">&lt;request</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">base64=</span><span class="s">"true"</span><span class="nt">&gt;</span><span class="cp">&lt;![CDATA[UE9TVCAvc2VhcmNo]]&gt;</span><span class="nt">&lt;/request&gt;</span>
      <span class="nt">&lt;response</span> <span class="na">base64=</span><span class="s">"true"</span><span class="nt">&gt;</span><span class="cp">&lt;![CDATA[SFRUUC8xLjEgMjAwIE9LDQpTZXJ2ZXI6IG5naW54L]]&gt;</span><span class="nt">&lt;/response&gt;</span>
      <span class="nt">&lt;responseRedirected&gt;</span>false<span class="nt">&lt;/responseRedirected&gt;</span>
    <span class="nt">&lt;/requestresponse&gt;</span>
  <span class="nt">&lt;/issue&gt;</span>
<span class="nt">&lt;/issues&gt;</span>
</code></pre></div></div>

<ul>
  <li>
    <p>Diger XXE saldirma cesidi ise, sunucuya upload edilen xml icine loop koyarak sunucunun cpu gucunu %100 yaparak sunucuyu devre disi birakmakdir.</p>
  </li>
  <li>
    <p>Diger bir XXE saldirisi DOCTYPE kismindan alinan parametrenin direk olarak xml icinde kullanilmasi ve calistirilmasidir.</p>
  </li>
</ul>

<h3 id="2-slowloris-saldirisi">2. SLOWLORIS saldirisi</h3>

<ul>
  <li>Content-Length”: headerinda kullanmamak lazim, Keep-Alive: contentin gelmesinde gecen suredir, bitince timeout ulur. IIS te Keep-Alive defaultu 5 saniyedir. Apache de 15 sn filandir. kucuk tutulmasi tavsiye edilir. saldiri, herbir veri gondermede tek karakter gondererek, keep-alive suresi kadar bekleyip bekleyip bir sonraki karakteri gonderir boylece length*keep-alive suresi kadar sunucu portunu acik tutarak sunucuyu tikar.</li>
</ul>

<p>ayni sekilde zabbix gibi tool lardan gelen hearth bitlerin portu acik tumasini engellemek icin, isletim sistmeindeki keep-alive zamanini kisaltmakta yapilabilri.</p>

<p>saldiri: ayni domainde calisan kullanicilara, mail at domaini kullanarak siteye script enjekte et, daha sonra kullanici tiklayinca cookie ler calinir. veya bir web sitesi yapilir ve kisinin oraya girmsi saglanir, kullanicninin tikladigi url e script gomebilir.</p>

<p>– normalizer kullanmak XSS sorununu cozer</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">[nomalizer kodu]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">Normalizer</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">URL</span><span class="p">(</span><span class="kt">string</span> <span class="n">input</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">bool</span> <span class="n">stillEncoded</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

            <span class="k">while</span> <span class="p">(</span><span class="n">stillEncoded</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">String</span> <span class="n">decodedInput</span> <span class="p">=</span> <span class="n">HttpUtility</span><span class="p">.</span><span class="nf">UrlDecode</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">decodedInput</span> <span class="p">==</span> <span class="n">input</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">stillEncoded</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">input</span> <span class="p">=</span> <span class="n">decodedInput</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="n">input</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">HTMLV1</span><span class="p">(</span><span class="kt">string</span> <span class="n">input</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">bool</span> <span class="n">stillEncoded</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

            <span class="k">while</span> <span class="p">(</span><span class="n">stillEncoded</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">String</span> <span class="n">decodedInput</span> <span class="p">=</span> <span class="n">HttpUtility</span><span class="p">.</span><span class="nf">HtmlDecode</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">decodedInput</span> <span class="p">==</span> <span class="n">input</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">stillEncoded</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">input</span> <span class="p">=</span> <span class="n">decodedInput</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="n">input</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">HTML</span><span class="p">(</span><span class="kt">string</span> <span class="n">input</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">bool</span> <span class="n">stillEncoded</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">stillEncoded</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">String</span> <span class="n">decodedInput</span> <span class="p">=</span> <span class="n">HttpUtility</span><span class="p">.</span><span class="nf">HtmlDecode</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">decodedInput</span> <span class="p">==</span> <span class="n">input</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">stillEncoded</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">input</span> <span class="p">=</span> <span class="n">decodedInput</span><span class="p">;</span>
                <span class="n">i</span><span class="p">++;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">&gt;</span><span class="m">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// kotu niyet yakalandi.</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="n">input</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>[egitim]</p>

<ul>
  <li>
    <p>normalizer de while loop yerine tek bir decode den gecir ve uyari bilgisini gonderdikten sonra IPban listesine ekle</p>
  </li>
  <li>
    <p>normalizer de request icindeki loop ta count siniri da olmali while loop cok fazla olursa sunucu performansini dusurmek te bir aciktir.</p>
  </li>
</ul>

<p>bu tip kotu niyetlerin hepsini 10 dakika boyunca sisteme sokmamak lazim bir onlem olarak, yada requesti direk olarak</p>

<p>IPbanlist yapilacak</p>

<ul>
  <li>
    <p>username minimum=5 maximum 15 olmali karakterler arasinda _ olmali rakam olmali buyuk kucuk harf olmali</p>
  </li>
  <li>
    <p>inputlari beyaz listeden gecirebiliriz.</p>
  </li>
</ul>

<p>controller daki actionlarin hepsinin tepesine [ ] validation kontrolu eklenecek hangi karakterlerden olusacak, max min length ne olarak</p>

<p>kod ile veri birbirine karistirildiginda injection zaatlari oluyor. kod ile veriyi karistirmamak lazim.</p>

<p>repository de veri encode edildikten sonra sql ile concat edilecek.</p>

<ul>
  <li>request validation a guven olmaz, herzaman hacklendi. (blacklisting ten bisey olmaz)</li>
</ul>

<h2 id="yazilimi-guvenli-yapmak-icin-uygulama-sirasi">yazilimi guvenli yapmak icin uygulama sirasi</h2>

<p>1- Normalizasyon ve kara liste 2- Beyaz Liste yukardaki uygulamanin girisinde yapili kodun cikisinda da encoding yapalim 3- Encode / Escape</p>

<p>kullanicidan aldigimiz bilgiyi baska bir yerde diger kullanicilara sunuyor isek burada XSS vardir.</p>

<p>bankalarda cookie icin IP kontrolude yapiliyor.</p>

<p>AntiXss librarysini nuget ten alip koyalim</p>

<h2 id="xss-onleme-kurallari">XSS onleme kurallari</h2>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">&lt;</span><span class="n">svg</span> <span class="n">onload</span><span class="p">=</span><span class="s">"alert(1)"</span><span class="p">&gt;</span>  <span class="n">esittir</span> <span class="p">&lt;</span><span class="n">script</span><span class="p">&gt;</span><span class="nf">alert</span><span class="p">(</span><span class="m">1</span><span class="p">)&lt;/</span><span class="n">script</span><span class="p">&gt;</span>
</code></pre></div></div>

<h2 id="1-kullanicidan-alinan-veriyi-htmlencode-ederek-sayfaya-basmak">1. Kullanicidan alinan veriyi HtmlEncode ederek sayfaya basmak</h2>

<p>System.Web.Security.AntiXss.AntiXssEncder, sistem icinekonulan antixss bunun haricinde bir de nuget tan indirmek daha iyi.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">&lt;%=</span><span class="n">Microsoft</span><span class="p">.</span><span class="n">Security</span><span class="p">.</span><span class="n">Application</span><span class="p">.</span><span class="n">Encoder</span><span class="p">.</span><span class="nf">HtmlEncode</span><span class="p">(</span><span class="s">""</span><span class="p">)&gt;</span>
</code></pre></div></div>

<h2 id="2">2.</h2>

<p>angular kullanirken razor render kullanmayacagiz render edilen seyi $scope.key=&lt;%=rendersomething% &gt; seklinde kullanmaliyiz.</p>

<p>encoding aldigimiz yerde degil, ciktigimiz yerlerde kullanmaliyiz.</p>

<p>attribute icinde encode kullanditimiz da tirnak kullanmak sart, fakat bu da yeterli degil encodingi bulundugumuz yere gore yapmamiz lazim, HtmlEncode, AttributeEncode, JavaScriptEncode , UrlEncode girilen karakterler encode edilmemis seklinde gonderilirse normalizasyondan geciyor bu yuzden en kesin cozum, output un encode edilmesidir.</p>

<h2 id="richtext-nasil-alinir">RichText nasil alinir</h2>

<p>HtmlSanitizer nuget ten indirilebilir. Whitelist usulu calismaktadir.</p>

<p>angular sanitizer bypass edilebiliyor. angular sanbox bypass seklinde aratilabilir.</p>

<p>zengin icerik alacaksak minimum zengin icerik etiketi kabul etmeliyiz. whitelist olusturmaliyiz.</p>

<h1 id="sql-injection">SQL injection</h1>

<ul>
  <li>
    <p>storedprocedure kullanmak sql injectionu engellemez</p>

    <p>’ or 1=1) – seklinde incejtion yapildi</p>

    <p>sql injectionun onlemi prepared statement kullanilmali sqlParameter …. eger sql keyword larinda kullanacaksak ta white list kullanacagiz.</p>
  </li>
</ul>

<h1 id="guvenli-upload">Guvenli Upload</h1>

<ol>
  <li>Dosya uzanti kontrolu yapilmali.</li>
  <li>Upload edilen dosya streem olarak bir Image objesine konur ve png olarak kaydedilir, bu durumda dosya icinde resim olmayan kisimlar temizlenerek kaydediliyor.</li>
  <li>Dosyalar wwwroot altina upload edilmemeli, web klasoru disinda bir yere upload edilmeli, doslayari indirmek isteyenler icin ise handler yazilmasi gerekmektedir.</li>
</ol>

<h1 id="os-commanding">OS Commanding</h1>

<p>web uuygulamsi icinden shell kullanilir ise kullanicidan parametre alinmamali alinirsade encode edilmeli.</p>

<h1 id="crlf">CR/LF</h1>

<p>kullanicinin log dosyasina sahte kayit atmasidir.</p>

<h1 id="ldap-filer-encoding">ldap filer encoding</h1>

<p>ldap ile calistigimizda mutlaka ldap encoding kullanmaliyiz.</p>

<h1 id="xpath-injection">XPath injection</h1>

<p>xml icindeki node lara ulasirken string concat kullanmamak kazim, her karakterini htmlEncode dan gecirmemiz lazim.</p>

<h2 id="encryption">Encryption</h2>

<p>base64 de encode edilen herseyin sonunda bir esittir = konulur.</p>

<p>Encrypting ile encoding karistirilmamali.</p>

<h3 id="simetrik-sifreleme">Simetrik sifreleme</h3>

<ol>
  <li>
    <p>anahtari olan bir sifreleme methodudur. gunumuzdeki en guvenli simetrik sifreleme algoritmasi AES</p>
  </li>
  <li>
    <p>AES icin ecb modunun kullanmasi guvensizdir. CBC kullanilmasi gerekiyor. cok bilindik bir algoritmada bile nasil kullanildigini bilmeden kullanmamak lazim. CBC de her dosya sifrelerken farkli IV kullanilmali.</p>
  </li>
  <li>
    <p>DES guvensiz bir algoritmadir.</p>
  </li>
  <li>
    <p>Hash cok hizli bir tekniktir. sadece formul calistiriyor.</p>
  </li>
  <li>
    <p>Hash yapildiktan sonra salting yapilmailidir.</p>
  </li>
  <li>
    <p>saldirganin hash hesaplama islemini yavaslatmak gerekli.</p>
  </li>
  <li>
    <p>Her sifrenin salt i farkli olmasi gerekiyor.</p>
  </li>
</ol>

<h2 id="guvenli-kimlik-dogrulama">Guvenli kimlik dogrulama</h2>

<p>Basic authenticationda gider parola networkten acik gider, araya herkes girebilir. uygulamalar arasi kimlik dogrulama,</p>

<ol>
  <li>ip adresi kontrol edilebilir.</li>
  <li>ortada load balancer varsa header a ip x-forwarder-for ile eklenir. forward eden tum proxyler virgul kullanilarak uc uca eklenir.</li>
</ol>

<h3 id="capcha-replay-zaafi">CAPCHA replay zaafi</h3>

<ol>
  <li>seri deneme yapilmasi engellenmelidir. IP banlama ve bekletme islimi yapilmali.</li>
</ol>

<p>capcha seri saldirilari engellemek icin kullaniriz. capcha imagini ureten kisim farkli ise ve kullanicinin capcha degeri sessiondan okundugunda sessiondaki silmek gerekir. capcha her kullanildiginda silinmelidir.</p>

<p>kimlik dogrulamada basarili basarisiz degerleri mutlaka loglamak gerekiyor. GuvenliParola uretimi icin Membership.GeneratePassword(8,2) kullanmak daha iyi olabilir.</p>

<h3 id="oturum-yonetimi">Oturum Yonetimi</h3>

<p>Browserlar tum requestlere site ile ilgili tum cookie ler eklenir.</p>

<h4 id="csrf-cross-site-request-forgery">CSRF Cross Site Request Forgery</h4>

<p>mesajlasan 2 kullanicidan birinin script icerikli bir mesaj atar ise, saldirgan, kurbana her istedigini yaptirabilir.</p>

<p>onlem: saldirganin hazirladigi sahte fromu anlamak icin, formun icine Html.AntiForgerToken() action methodunun attribute una da [ValidateAntiForgeryToken]</p>

<p>once ugulamada XSS onelmi alinmali sonra forgerytoken kullanmaliyiz</p>

<p>logout ta bile post kullanilmali. mumkun olan her yerde post kullanilmali</p>

<p>SSL olan bir sitede SSL olmayan bir kisim olmamali asp.net in forms authentication kullanilmasi gerekir.</p>

<h3 id="file-download">File Download</h3>

<p>file download larda kullanicidan gelen dosya isimlerinin normalize edilmesi ve whitelist kullanilabilir.</p>

<p>onlem <code class="highlighter-rouge">charp string gelenFileName=".../.../"; File f=new File(gelenFileName); if(f.Name!= gelenFileName){ //yakalandi }</code></p>

<h1 id="mass-assigment">Mass Assigment</h1>

<p>burada kullanicilara mutlarak veritabanindaki modelin aynisi gonderilmemeli, mutlaka viewmodel gonderilmeli.</p>

<p>MD5 basit bir algoritma guvenilmezdir.</p>

<p>wifi hackleme yontemi= ARP poissing</p>

<p>browser icinde JSON.Parse demek gerekiyor.</p>

<p>16 farkli saldiri cesidi ogrenildi hepsnin tane tane yazilmasi lazim.</p>

<ul>
  <li>
    <p>sayfanin iframe ye mesaj gondermesi mumkun postMessage ile mesaji alan iframe penceresindeki uygulama encode yapmasi gerekiyor.</p>
  </li>
  <li>
    <p>uygulamamnin iframede calismasi engellencek</p>
  </li>
  <li>
    <p>Frame Busting Code sayesinde sayfanin iframe de acilmasi gengellenebilir.</p>
  </li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="nx">windows</span><span class="p">.</span><span class="nx">top</span><span class="o">!=</span><span class="nx">docuemnt</span><span class="p">.</span><span class="nx">location</span><span class="p">){</span>
  <span class="c1">//icerdeki sayfa disariyi eziyor ve tum sayfayi kendisi degistiriyor.</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="o">=</span><span class="s2">"http://www.abc.com"</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>
    <p>localStorage[“key”]=value persistent bir storage</p>
  </li>
  <li>
    <p>sessionStorage[“key”]= value bu browser acik kaldigi surece tutuluyor</p>
  </li>
  <li>
    <p>Jquery nin html encode yontemi var. JQEncder kullanmak gerekir</p>

    <p>​</p>
  </li>
</ul>

                  </article>

  

  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://localhost:4000/guvenli-kod-gelistirme/';
      this.page.identifier = 'http://localhost:4000/guvenli-kod-gelistirme/';
    };
    (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



                </div>
                <aside>

              </aside>
            </div>
        </section>
            <br>
        <footer class="container">
            <div class="container" style="background-color:#f6f8fa;">
  <div class="row">

    <div class="col-md-3">
      <ul>

        <li><a href="/about/">Hakkimda</a></li>
   <li><p class="rss-subscribe"> <a href="/feed.xml">RSS</a></p></li>
      </ul>
    </div>
    <div cclass="col-md-3">
      <ul>

        <li><a href="/contact/">İletişim</a></li>

      </ul>
    </div>
    <div class="col-md-3">

    </div>
  </div>
</div>
<hr>
<div class="row-fluid">
  <div>
    <div  class="col-md-6">
      <a href="#">Kullanim kosullari</a>
      <a href="#">Gizlilik</a>
      <a href="#">Guvenlik</a>
    </div>
    <div  class="col-md-6">
      <p class="muted pull-right">© 2017 Atilla Tanrikulu.</p>
    </div>
  </div>
</div>

        </footer>
  <!--#region BASE --> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!--#endregion BASE-->

<!--#region CORE-->
<script src="/assets/js/core.js"></script>
<!--#endregion CORE-->

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-109069515-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-109069515-1');
  </script>

  </body>
</html>
